<!DOCTYPE html>
<html>
<head>

   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Handling custom tags in Android using Html.TagHandler()</title>
   <meta name="author" content="GitWatcher" />

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/css/syntax.css" type="text/css" />

   <!-- Twitter Bootstrap CSS -->
   <!-- link rel="stylesheet" href="/blog/css/bootstrap.min.css" type="text/css" media="screen, projection" / -->
   <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.1.1/css/bootstrap-combined.min.css" rel="stylesheet">
   <link href='http://fonts.googleapis.com/css?family=Josefin+Slab' rel='stylesheet' type='text/css'>
   <link rel="stylesheet" type="text/css" href="/css/screen.css">
   <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-37269036-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>

<body>

  <div id="page">

   <!-- Twitter Bootstrap navbar -->

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">

            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>

          <a class="brand" href"/">Blog-Mohammed Lakkadshaw</a>
          <div class="nav-collapse">
            <ul class="nav pull-right">
              <li><a href="/">Blog</a></li>
              <li><a href="/about.html">About</a></li>
              <li><a href="/lab.html">Lab</a></li>
            </ul>
            <!-- form method="get" action="http://www.google.com/search" class="navbar-search pull-right">
              <input type="text" name="q" class="span2 search-query" placeholder="Search" maxlength="255" value="">
              <input name="sitesearch" type="hidden" value="">
            </form -->
          </div>
        </div>
      </div>
    </div>

    <!-- Main content area -->

    <div class="container">
      <div class="content">
        <header class="page-header">
          <h1></h1>
        </header>
        <div class="row">
          <div id="content" class="span9">
            <article>
  <header>
    <h2>
      <a href="/Handling_Custom_Tags_Using_Html.tagHandler%28%29.html" rel="bookmark" title="Permanent link to ">Handling custom tags in Android using Html.TagHandler()</a>
    </h2>
    <h5>
        <!-- avatar><img 
		class="avatar"
		src="http://s.gravatar.com/avatar/?s=40"
		alt="Mohammed Lakkadshaw"
		width="40"
		height="40">
        </avatar -->
        <time>June 12, 2013</time> - 
        <author>Mohammed Lakkadshaw</author>
    </h5>
  </header>
  <!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
<a class="addthis_button_tweet"></a>
<a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a>
<a class="addthis_counter addthis_pill_style"></a>
</div>
<script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-525120737188c41f"></script>
<!-- AddThis Button END -->

  <p /><br /><p /><p>While working on my app <a href="https://play.google.com/store/apps/details?id=com.mohammedlakkadshaw.ken&amp;hl=en">Android app Ken</a>, I needed to render HTML in Android, I was very much delighted when I found out that android's TextView supports HTML rendering and it can be easily achived by converting html into <a href="http://developer.android.com/reference/android/text/Spannable.html">Spannable</a> using <strong>Html.fromHtml(&lt;html_Content)</strong> method and sending it to TextView's setText method.</p>

<pre><code>TextView myTxt = (TextView)findViewById(R.id.textView);
myTxt.setText(Html.fromHtml(htmlContent,ImageHandler,TagHandler));
</code></pre>

<p>But there is catch with Html.fromHtml method, it doesn't support all tags; well that was a killjoy, but html.fromHtml method accpets a TagHandler which is class we can implement to handle custom html tags, but it is not well documented, after struggling for a while and reading the source code of HTML class method I was finally able to define my own tagHandler class which is able to handle ul, ol and code tags.</p>

<h2>Handling Html</h2>

<p>Here is my custom tagHandler:</p>

<script src="https://gist.github.com/mlakkadshaw/5983704.js"></script>


<p>The above Java file HtmlTagHandler handles, ul, ol, and code tags.
The <strong>handleTagList()</strong> method handles the list tags, and handling of code tag was pretty easy, I just need to find the start of the code tag, I do this by adding a flag on the start of the tag <strong>Spannable.SPAN_MARK_MARK</strong> and when the tag on end I just find the object where I marked <strong>Spannable.SPAN_MARK_MARK</strong> using <strong>getLast()</strong> and find its position, and store it in the variable name <strong>"where"</strong>; that's the start of the code tag, and I get the end of the code tag using output.length() and set the font face of that text fragment to "monospace" using <strong>(new TypefaceSpan("monospace")</strong>.</p>

<p>That's it! If you want to use it in your project create a java class with content of this file and create a object of HtmlTagHandler and pass it to your fromHtml method.</p>

<p>Also try out my app <a href="https://play.google.com/store/apps/details?id=com.mohammedlakkadshaw.ken&amp;hl=en">Ken which is available on Google Play</a> which a free magazine for programmers, you have to select your interest (e.g Javascript, Android, Ruby etc.) and it will show you all the latest news, articles, tutorials related to your interests.</p>

<p>P.S: For handling image I using a nice library called <strong>"URLImageParser"</strong> <a href="https://gist.github.com/Antarix/4167655">Github link</a></p>


<div class="well">
  <nav id="related">
    <h3>Related Posts</h3>
    <ul class="posts">
      
        <p><li><span>03 Aug 2013</span> - <a href="/Executing_tasks_on_specific_dates_nodejs.html">Executing tasks (functions) on specific dates in Node.js</a></li></p>
      
        <p><li><span>02 Aug 2013</span> - <a href="/AngularJS_Underscore_ultimate_web_development.html">AngularJS + Underscore The ultimate web-development toolkit</a></li></p>
      
        <p><li><span>14 Jun 2013</span> - <a href="/An_app_every_programmer_must_use.html">An app every programmer must use</a></li></p>
      
        <p><li><span>13 Jan 2013</span> - <a href="/Peer_JS_Performace.html">PeerJS How does it work?</a></li></p>
      
        <p><li><span>31 Dec 2012</span> - <a href="/Android_as_display.html">Use your Android Phone as a display for Raspberrypi</a></li></p>
      
    </ul>
  </nav>
</div>

 
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'blogmohammedlakkadshaw'; // required: replace example with your forum shortname
            /*var disqus_developer = 1; // This turns developer mode on
                                      // Make sure you remove this before you push this
                                      // to your live site.

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
 

<!-- 
  
-->

</article>

          </div>
          <nav class="span3">
          <p class='lead'>
          	I'm avaliable for freelance web and mobile development.
          </p>
          <p>Email: mohammed.lakkadshaw@gmail.com</p>
            <div id="social networks" class="rss twitter" >
              <a href="https://twitter.com/m_lakkadshaw">
                <img src="/images/twitter.png" alt="Follow me on Twitter" width='100px' />
              </a>
            </div>
           
            <h3>Recent Posts</h3>
            <hr />
            <div id="posts">
              
                <p><a href="/Executing_tasks_on_specific_dates_nodejs.html">Executing tasks (functions) on specific dates in Node.js</a></p>
              
                <p><a href="/AngularJS_Underscore_ultimate_web_development.html">AngularJS + Underscore The ultimate web-development toolkit</a></p>
              
                <p><a href="/An_app_every_programmer_must_use.html">An app every programmer must use</a></p>
              
                <p><a href="/Handling_Custom_Tags_Using_Html.tagHandler%28%29.html">Handling custom tags in Android using Html.TagHandler()</a></p>
              
                <p><a href="/Peer_JS_Performace.html">PeerJS How does it work?</a></p>
              
                <p><a href="/Android_as_display.html">Use your Android Phone as a display for Raspberrypi</a></p>
              
              <hr>
              <p>powered by <a href="https://github.com/mojombo/jekyll">jekyll</a></p>
            </div>
          </nav>
        </div>
      </div>
      <hr />
      <footer>
  <div class="row">
    <div class="span10">
      <p class="Copyright 2011-2012">&copy; 2012 Mohammed Lakkadshaw</p>
    </div>
  </div>
</footer>

    </div> 

  </div> 

  <!-- End Main content area -->

</body>
</html>

